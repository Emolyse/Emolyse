<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<script src="http://threejs.org/build/three.min.js"></script>
<script src="js/ColladaLoader.js"></script>
<script src="js/Detector.js"></script>
<script src="js/stats.min.js"></script>
<script>
    var color = 0x000000;

    // Create your main scene
    var scene = new THREE.Scene();

    // Create your main camera
    var camera = new THREE.PerspectiveCamera( 25, window.innerWidth / window.innerHeight, 1, 10000 );
    camera.position.set( 0, -10, 0);
    camera.up.set( 0, 1, 0 );

    // Create lights
    var light = new THREE.PointLight(0xEEEEEE);
    light.position.set(20, 0, 20);
    scene.add(light);

    var lightAmb = new THREE.AmbientLight(0x777777);
    scene.add(lightAmb);

    // Create your renderer
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);



    // Set up the main camera
    camera.position.z = 5;

    // Load the background texture
    var texture = THREE.ImageUtils.loadTexture( 'img/env.jpg' );
    var backgroundMesh = new THREE.Mesh(
            new THREE.PlaneGeometry(2, 2, 0),
            new THREE.MeshBasicMaterial({
                map: texture
            }));

    backgroundMesh .material.depthTest = false;
    backgroundMesh .material.depthWrite = false;

    // Create your background scene
    var backgroundScene = new THREE.Scene();
    var backgroundCamera = new THREE.Camera();
    backgroundScene .add(backgroundCamera );
    backgroundScene .add(backgroundMesh );


    var loader = new THREE.ColladaLoader();
    loader.load( "3D/avatar.dae", function ( collada ) {

        collada.scene.traverse( function ( child ) {

            if ( child instanceof THREE.SkinnedMesh ) {

                var animation = new THREE.Animation( child, child.geometry.animation );
                animation.play();

                camera.lookAt( child.position );

            }

        } );
        console.log(collada);
        scene.add( collada.scene );

    } );

    // Rendering function
    var render = function () {


        requestAnimationFrame(render);

        renderer.autoClear = false;
        renderer.clear();
        renderer.render(backgroundScene, backgroundCamera);
        renderer.render(scene, camera);

    };
    render();
</script>
</body>
</html>